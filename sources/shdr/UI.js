// Generated by CoffeeScript 1.4.0
(function() {
  var UI;

  UI = (function() {

    function UI(app) {
      this.app = app;
      this.initBehaviors();
    }

    UI.prototype.initBehaviors = function() {
      var _this = this;
      $('.menu-trigger').on('click.on', function(e) {
        return _this.onMenuTrigger(e);
      });
      return $('.menu-item').on('click', function(e) {
        return _this.onMenuItem(e);
      });
    };

    UI.prototype.onMenuTrigger = function(event) {
      var el, list, root,
        _this = this;
      el = $(event.target);
      root = el.parent();
      list = root.find('.menu-list');
      el.addClass('open');
      list.fadeIn();
      $(document).on('click.menu-trigger', function() {
        return _this.offMenuTrigger(el, list);
      });
      el.off('click.on');
      el.on('click.off', function(e) {
        return _this.offMenuTrigger(el, list);
      });
      return event.stopPropagation();
    };

    UI.prototype.offMenuTrigger = function(el, list) {
      var _this = this;
      el.removeClass('open');
      el.off('click.off');
      el.on('click.on', function(e) {
        return _this.onMenuTrigger(e);
      });
      list.fadeOut();
      return $(document).off('click.menu-trigger');
    };

    UI.prototype.onMenuItem = function(event) {
      var el, index, item, list, root, _name;
      item = $(event.target);
      list = item.parent();
      root = list.parent();
      el = root.find('.menu-trigger');
      index = item.attr('data-index');
      el.text(item.text());
      el.attr('data-index', index);
      if (typeof this[_name = root.attr('data-action') + 'Action'] === "function") {
        this[_name](index);
      }
      this.offMenuTrigger(el, list);
      return event.stopPropagation();
    };

    UI.prototype.updateAction = function(index) {
      return this.app.setUpdateMode(index);
    };

    return UI;

  })();

  this.shdr || (this.shdr = {});

  this.shdr.UI = UI;

}).call(this);
